<div class="container">
    <h2>Applied Conference Events</h2>

    <div class="controls">
        <!-- <input type="text" [(ngModel)]="searchValue" (input)="filterBookings()" placeholder="Search by Occupation"> -->
        <button (click)="toggleSort(1)" class="sort-btn">Sort Date by Asc</button>
        <button (click)="toggleSort(-1)" class="sort-btn">Sort Date by Desc</button>
    </div>

    <table>
        <thead>
            <tr>
                <th>S.No</th>
                <th>Event Name</th>
                <th>Organiser Name</th>
                <th>Occupation</th>
                <th>Gender</th>
                <th>City</th>
                <th>Booking Date</th>
                <th>Booking Status</th>
                <th>Additional Notes</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody *ngIf="filteredBookings.length; else noRecords">
            <tr *ngFor="let booking of filteredBookings | slice:(page-1)*limit:(page*limit); let i = index">
                <td>{{ (page - 1) * limit + i + 1 }}</td>
                <td>{{ booking.ConferenceEvent.EventName }}</td>
                <td>{{ booking.ConferenceEvent.OrganizerName }}</td>
                <td>{{ booking.Occupation }}</td>
                <td>{{ booking.Gender || 'NA' }}</td>
                <td>{{ booking.City || 'NA' }}</td>
                <td>{{ booking.BookingDate | date }}</td>
                <td>{{ booking.BookingStatus || 'NA' }}</td>
                <td>{{ booking.AdditionalNotes || 'NA' }}</td>
                <td>
                    <button (click)="viewProof(booking.Proof)" class="proof-btn">View Proof</button>
                    <button (click)="handleDeleteClick(booking)" [disabled]="booking.BookingStatus === 'Accepted'"
                        [ngClass]="{ 'disabled-btn': booking.BookingStatus === 'Accepted' }" class="delete-btn">
                        Delete
                    </button>
                </td>
            </tr>
        </tbody>
        <ng-template #noRecords>
            <tbody>
                <tr>
                    <td colSpan="9" class="no-records-cell">Oops! No records found</td>
                </tr>
            </tbody>
        </ng-template>
    </table>

    <div class="pagination">
        <button (click)="page = page - 1" [disabled]="page === 1">Prev</button>
        <span>Page {{ page }} of {{ totalPages() }}</span>
        <button (click)="page = page + 1" [disabled]="page >= totalPages()">Next</button>
    </div>

    <!-- <div *ngIf="showProofModal" class="modal">
        <div class="modal-content">
            <span class="close" (click)="closeProofModal()">&times; Close</span>
            <img [src]="proofSrc" alt="Proof Image">
        </div>
    </div> -->
    <div *ngIf="showProofModal" class="modal-overlay">
        <div class="modal-content">
            <button id="close-modal" (click)="closeProofModal()">X</button>
            <img [src]="proofSrc" alt="Proof Document" />
        </div>
    </div>


    <div *ngIf="showDeletePopup" class="modal-overlay">
        <div class="modal-content">
            <p>Are you sure you want to delete this booking?</p>
            <button (click)="handleConfirmDelete()" class="yes-btn">Yes</button>
            <button (click)="closeDeletePopup()" class="no-btn">No</button>
        </div>
    </div>
</div>