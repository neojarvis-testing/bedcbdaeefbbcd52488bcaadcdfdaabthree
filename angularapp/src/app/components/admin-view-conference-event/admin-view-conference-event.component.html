<div id="parent">
  <div id="conferenceEventHomeBody" [ngClass]="{ blur: showDeletePopup }">
    <h1>Conference Event Listings</h1>
    <hr>
    <div class="top-container">
      <input id="searchBox" type="text" placeholder="Search by Event Name, Organizer, or Location"
        [(ngModel)]="searchValue" (ngModelChange)="handleSearchChange($event)" />
    </div>

    <table class="conference-event-table">
      <thead>
        <tr>
          <th>S.No</th>
          <th>Event Name</th>
          <th>Organizer</th>
          <th>Category</th>
          <th>Description</th>
          <th>Location</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Capacity</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody *ngIf="status === 'loading'">
        <tr>
          <td colspan="10">Loading...</td>
        </tr>
      </tbody>
      <tbody *ngIf="status === 'error'">
        <tr>
          <td colspan="10">Error loading data</td>
        </tr>
      </tbody>
      <tbody *ngIf="conferenceEvents.length > 0; else noRecords">
        <tr *ngFor="let event of conferenceEvents | slice:(page-1)*limit:(page*limit); let i = index">
          <td>{{ (page - 1) * limit + i + 1 }}</td>
          <td>{{ event.EventName }}</td>
          <td>{{ event.OrganizerName }}</td>
          <td>{{ event.Category }}</td>
          <td>{{ event.Description }}</td>
          <td>{{ event.Location }}</td>
          <td>{{ event.StartDateTime | date: 'short' }}</td>
          <td>{{ event.EndDateTime | date: 'short' }}</td>
          <td>{{ event.Capacity }}</td>
          <td>
            <button (click)="navigateToEditEvent(event.ConferenceEventId)">Edit</button>
            <button (click)="handleDeleteClick(event.ConferenceEventId)" id="deleteButton">
              Delete
            </button>
          </td>
        </tr>
      </tbody>
      <ng-template #noRecords>
        <tr>
          <td colspan="10" class="no-records-cell">Oops! No records found</td>
        </tr>
      </ng-template>
    </table>
  </div>

  <div *ngIf="showDeletePopup" class="delete-popup">
    <p>Are you sure you want to delete this event?</p>
    <button (click)="handleConfirmDelete()" id="delete-btn">Yes, Delete</button>
    <button (click)="closeDeletePopup()">Cancel</button>
    <div id="errorMessage" *ngIf="errorMessage">{{ errorMessage }}</div>
  </div>

</div>

<div class="pagination">
  <button (click)="page = page - 1" [disabled]="page === 1">Prev</button>
  <span>Page {{ page }} of {{ this.totalPages }}</span>
  <button (click)="page = page + 1" [disabled]="page >= this.totalPages">Next</button>
</div>